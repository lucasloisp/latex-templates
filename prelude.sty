\ProvidesPackage{prelude}

\newif\if@flagcode\@flagcodefalse
\DeclareOption{code}{\@flagcodetrue}

\newif\if@flagemoji\@flagemojifalse
\DeclareOption{emoji}{\@flagemojitrue}

\newif\if@flagdraw\@flagdrawfalse
\DeclareOption{draw}{\@flagdrawtrue}

\newif\if@flagprose\@flagprosefalse
\DeclareOption{prose}{\@flagprosetrue}

\newif\if@flagheader\@flagheaderfalse
\DeclareOption{header}{\@flagheadertrue}

\ProcessOptions\relax

%% Colors
\usepackage{xcolor}

%% Refs
\usepackage{nameref}

\usepackage{hyperref}

%% Visuals
\usepackage{fancyhdr}
\usepackage{graphicx}
\usepackage{enumitem}

\usepackage{import}
\usepackage{subcaption}
\graphicspath{ {img/} }
\overfullrule=2cm
\newcommand{\incfig}[1]{%
	    \def\svgwidth{\columnwidth}
      \import{./figures/}{#1.pdf_tex}
}

\usepackage{float}

\usepackage{booktabs}
\usepackage{tabularx}
\newcolumntype{L}{>{\raggedright\arraybackslash}X}

%% Misc.
\usepackage{blindtext}

%% Bibliography
\usepackage[
backend=biber,
block=ragged,
style=apa,
citestyle=apa
]{biblatex}
\DefineBibliographyStrings{spanish}{%
andothers = {et\addabbrvspace al\adddot}
}

\if@flagemoji
  \usepackage{xltxtra}
  \usepackage{xelatexemoji}
  \renewcommand{\xelatexemojipath}[1]{emojis/#1.pdf}
\fi

%% Code Snippets
\if@flagcode
  \usepackage{minted}
  \counterwithin{listing}{chapter}
\fi

\if@flagdraw
  \usepackage{tikz}
  \usepackage{tikz-network}
\fi

\if@flagprose
  \usepackage{titling}
  % copied from https://tex.stackexchange.com/a/196650/95423
  \makeatletter
  \newcommand{\@subtitle}{}
  \newcommand{\subtitle}[1]{\renewcommand{\@subtitle}{#1}}
  \newcommand{\@supervisor}{}
  \newcommand{\supervisor}[1]{\renewcommand{\@supervisor}{#1}}
  \newcommand{\@course}{}
  \newcommand{\course}[1]{\renewcommand{\@course}{#1}}
  \newcommand{\@institute}{}
  \newcommand{\institute}[1]{\renewcommand{\@institute}{#1}}
  \newcommand{\@institutelogo}{}
  \newcommand{\institutelogo}[1]{\renewcommand{\@institutelogo}{#1}}
  \makeatother
\fi

\if@flagheader
  \pagestyle{fancy}
  \fancyhead{}
  \rhead{\makeatletter \@course \makeatother}
  \lhead{\thetitle}
\fi
